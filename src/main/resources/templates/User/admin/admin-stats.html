<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" class="h-100">
<head>
  <meta charset="UTF-8">
  <title>Statystyki produktów</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <link th:href="@{/styles/main.css}" rel="stylesheet"/>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <link th:href="@{/styles/navbar.css}" rel="stylesheet"/>
  <script src="/scripts/navbar.js" defer></script>
</head>

<body class="d-flex flex-column min-vh-100">

<div th:replace="~{fragments/header :: header}"></div>

<div class="container my-5 text-center">
  <h1 class="mt-4 mb-4">Statystyki produktów – liczba dodanych produktów w tygodniu</h1>

  <form method="get" action="/admin/admin-stats" class="mb-3">
    <button class="btn btn-outline-primary me-2" type="submit" name="weekStart" th:value="${previousWeek}">&laquo; Poprzedni tydzień</button>
    <button class="btn btn-outline-primary" type="submit" name="weekStart" th:value="${nextWeek}">Następny tydzień &raquo;</button>
  </form>

  <p class="mb-4 fw-bold" th:text="'Wybrany tydzień: ' + ${weekStart} + ' - ' + ${weekStart.plusDays(6)}"></p>

  <div class="d-flex justify-content-center">
    <canvas id="productChart" width="600" height="300"></canvas>
  </div>
</div>

<div th:replace="~{fragments/footer :: footer}"></div>

<script th:inline="javascript">
  /*<![CDATA[*/
  const labels = [[${stats.keySet()}]];
  const data = [[${stats.values()}]];

  const ctx = document.getElementById('productChart').getContext('2d');
  new Chart(ctx, {
      type: 'bar',
      data: {
          labels: labels,
          datasets: [{
              label: 'Liczba dodanych produktów',
              data: data,
              backgroundColor: 'rgba(75, 192, 192, 0.5)',
              borderColor: 'rgba(75, 192, 192, 1)',
              borderWidth: 1
          }]
      },
      options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
              y: {
                  beginAtZero: true,
                  ticks: {
                      stepSize: 1
                  }
              }
          }
      }
  });
  /*]]>*/
</script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs="
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>

</body>
</html>
